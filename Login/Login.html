<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-translate="login.pageTitle">Login - MetaClass</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="../css/site-enhanced.css" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
</head>

<body class="login-page">

    <div class="login-container">
        <div class="login-card">

            <div class="logo-container">
                <img src="../logo.png" alt="MetaClass Logo" />
            </div>

            <h2 class="login-title"><span data-translate="login.welcomeBack">Welcome Back</span></h2>
            <p class="login-subtitle"><span data-translate="login.signInAccess">Sign in to access your account</span></p>

            <!-- LOGIN FORM -->
            <form id="loginForm">

                <div id="errorSummary" class="alert alert-danger d-none" role="alert"></div>

                <!-- EMAIL -->
                <div class="mb-3">
                    <label class="form-label fw-semibold">
                        <span data-translate="login.emailAddress">Email Address</span>
                    </label>
                    <div class="input-group">
                        <span class="input-group-text">
                            <i class="fas fa-envelope"></i>
                        </span>
                        <input id="email" type="email" class="form-control" 
                               placeholder="Email" />
                    </div>
                    <small id="emailError" class="text-danger small"></small>
                </div>

                <!-- PASSWORD -->
                <div class="mb-3">
                    <label class="form-label fw-semibold">
                        <span data-translate="login.password">Password</span>
                    </label>
                    <div class="input-group">
                        <span class="input-group-text">
                            <i class="fas fa-lock"></i>
                        </span>
                        <input id="password" type="password" class="form-control" 
                               placeholder="Password" />
                    </div>
                    <small id="passwordError" class="text-danger small"></small>
                </div>

                <small id="userError" class="text-danger small"></small>

                <!-- REMEMBER ME -->
                <div class="mb-4 form-check">
                    <input id="rememberMe" type="checkbox" class="form-check-input" />
                    <label for="rememberMe" class="form-check-label">
                        <span data-translate="login.rememberMe">Remember me on this device</span>
                    </label>
                </div>

                <button type="submit" class="btn btn-login w-100">
                    <i class="fas fa-sign-in-alt me-2"></i>
                    <span data-translate="login.signIn">Sign In</span>
                </button>
            </form>

            <div class="info-box mt-3">
                <a href="./ForgotPassword.html">
                    <h6><i class="fas fa-info-circle"></i> 
                        <span data-translate="login.forgotPassword">Forgot password?</span>
                    </h6>
                </a>
            </div>
        </div>

        <p class="copyright mt-4 text-center">
            &copy; <span id="year"></span> 
            <span data-translate="footer.copyright">MetaClass University Booking System</span><br>
            <small><span data-translate="footer.poweredBy">Powered by MetaClass Technology</span></small>
        </p>
    </div>

<script>
    // Set year automatically
    document.getElementById("year").innerText = new Date().getFullYear();

    // FORM VALIDATION + SUBMIT
    document.getElementById("loginForm").addEventListener("submit", function (e) {
        e.preventDefault();
        
        let errors = [];

        const email = document.getElementById("email").value.trim();
        const password = document.getElementById("password").value.trim();

        // Reset errors
        document.getElementById("errorSummary").classList.add("d-none");
        document.getElementById("emailError").innerText = "";
        document.getElementById("passwordError").innerText = "";
        document.getElementById("userError").innerText = "";


        // LOGIN CHECK
        if (email === "admin@polytechnic.am" && password === "admin") {
            localStorage.setItem("isLoggedIn", "admin");
            window.location.href = "../Dashboard/Dashboard.html";
            return;
        }

        if (email === "user@polytechnic.am" && password === "user") {
            localStorage.setItem("isLoggedIn", "user");
            window.location.href = "../User/Dashboard.html";
            return;
        }

        // WRONG CREDENTIALS
        errors.push("Incorrect Email address or password");
        document.getElementById("userError").innerText = "";
        document.getElementById("errorSummary").classList.remove("d-none");

        // Show errors if empty fields
        if (errors.length > 0) {
            const errorBox = document.getElementById("errorSummary");
            errorBox.innerHTML = errors.join("<br>");
            errorBox.classList.remove("d-none");
            return;
        }
    });
</script>
<script src="../js/translations.js"></script>
<script src="../js/transliteration.js"></script>
<script src="../js/theme-language.js"></script>
<script src="../js/language.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>

<script>
    // If user is logged in, redirect away from login page
    if (localStorage.getItem("isLoggedIn") == "admin") {
        window.location.href = "../Dashboard/Dashboard.html";
    }
    if (localStorage.getItem("isLoggedIn") == "user") {
        window.location.href = "../User/Dashboard.html";
    }
    
</script>

</html>
